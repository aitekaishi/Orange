(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order-from/order-from"],{1170:function(e,t,s){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(s("eaa7"));function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,s):{};a.get||a.set?Object.defineProperty(t,s,a):t[s]=e[s]}return t.default=e,t}var r={data:function(){return{items:[],orderlen:"",payment:""}},onUnload:function(){console.log(e.getStorageSync("fuqian")),1==e.getStorageSync("fuqian")&&(e.navigateTo({url:"../index/index"}),e.removeStorageSync("fuqian"))},onShow:function(){var t=this;e.setStorageSync("activeIndex",2);var s=new a.Query("Order");s.equalTo("user",a.User.current()),s.find().then(function(s){t.orderlen=s.length;for(var a=[],i=0;i<s.length;i++){"待支付"==s[i].attributes.status&&console.log(30-(new Date-new Date(s[i].createdAt))/6e4),a.push(s[i].createdAt),i==s.length-1&&e.setStorageSync("createdAt",a.reverse());for(var r=0;r<s[i].attributes.server.length;r++)s[i].attributes.server[r]=s[i].attributes.server[r].name}var n=[];console.log("_this.items"),n=s.reverse();for(var o=0;o<n.length;o++)n[o].attributes["xixi"]=30-(new Date-new Date(n[o].createdAt))/6e4>0;t.items=n,console.log(t.items);for(var c=0;c<t.items.length;c++)console.log(t.items[c]);console.log(e.getStorageSync("createdAt")),console.log(new Date);for(var l=0;l<t.items.length;l++){var u="",v="";u=new Date(t.items[l].createdAt).getMonth()+1>9?new Date(t.items[l].createdAt).getMonth()+1:"0"+(new Date(t.items[l].createdAt).getMonth()+1),v=new Date(t.items[l].createdAt).getDate()>9?new Date(t.items[l].createdAt).getDate():"0"+new Date(t.items[l].createdAt).getDate(),t.items[l].createdAt=new Date(t.items[l].createdAt).getFullYear()+"-"+u+"-"+v}})},methods:{order:function(t){var s=this;console.log(s.items[t]),console.log(new Date(e.getStorageSync("createdAt")[t])),e.setStorageSync("itemOne",s.items[t]),e.setStorageSync("baoxian",s.items[t].attributes.insurancePrice),e.setStorageSync("createdAtIndex",e.getStorageSync("createdAt")[t]),e.setStorageSync("updatedAtIndex",s.items[t].updatedAt),"已支付"==s.items[t].attributes.status?e.navigateTo({url:"../order-details/order-details"}):e.navigateTo({url:"../payment/payment"})},assess:function(t){e.setStorageSync("assessOrder",t),console.log(this.items[t]),e.setStorageSync("indexServerType",this.items[t].attributes.serviceType),e.navigateTo({url:"../assess/assess"})},pay:function(t){var s=this;a.Cloud.run("wxOrder",{productDescription:"佰橙科技-装修监理费",amount:100*s.items[t].attributes.total}).then(function(i){console.log(i),i.success=function(){var i=a.Object.createWithoutData("Order",s.items[t].id);i.destroy().then(function(i){var r=a.Object.extend("Order"),n=new r;n.set("user",a.User.current()),n.set("city",s.items[t].attributes.city),n.set("name",s.items[t].attributes.name),n.set("mobilePhoneNumber",s.items[t].attributes.mobilePhoneNumber),n.set("area",parseFloat(s.items[t].attributes.area)),n.set("status","已支付"),n.set("total",s.items[t].attributes.total),n.set("serviceType",s.items[t].attributes.serviceType),n.set("server",s.items[t].attributes.server),n.set("servicePrice",s.items[t].attributes.servicePrice),n.set("address",s.items[t].attributes.address),n.set("insuranceType",s.items[t].attributes.insuranceType),n.set("insurancePrice",s.items[t].attributes.insurancePrice),n.set("insuranceId",s.items[t].attributes.insuranceId),n.save().then(function(t){e.hideLoading(),e.showToast({title:"支付成功",duration:1e3}),setTimeout(function(){e.navigateTo({url:"../index/index"})},1e3)},function(t){e.hideLoading(),console.log(t)})},function(e){})},i.fail=function(t){t.errMsg;e.showToast({title:"支付失败",duration:1e3,icon:"none"})},e.requestPayment(i)}).catch(function(e){console.log(e)})}}};t.default=r}).call(this,s("543d")["default"])},1549:function(e,t,s){"use strict";s.r(t);var a=s("5c74"),i=s("f2aa");for(var r in i)"default"!==r&&function(e){s.d(t,e,function(){return i[e]})}(r);s("9df5");var n=s("2877"),o=Object(n["a"])(i["default"],a["a"],a["b"],!1,null,"5bb9710a",null);t["default"]=o.exports},"5c74":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("view",{staticClass:"order-from"},[e._l(e.items,function(t,a){return s("view",{key:t.orderId,class:e.orderlen?"":"none"},[s("view",{staticClass:"nonea"}),s("view",{staticClass:"order-contain"},[s("view",{staticClass:"one"},[s("view",{staticClass:"one-one"},[e._v("订单号："+e._s(t.orderId))]),s("view",{staticClass:"one-two",class:{xixibbb:"待支付"==t.status&&1==t.xixi}},[e._v("待支付")]),s("view",{staticClass:"one-two",class:{xixibbb:"待支付"==t.status&&0==t.xixi}},[e._v("已关闭")]),s("view",{staticClass:"one-two",class:{xixibbb:"已支付"==t.status}},[e._v("已支付")])]),s("view",{staticClass:"two"},[e._v(e._s(t.createdAt))]),s("view",{staticClass:"br"}),s("view",{staticClass:"three"},[s("view",{staticClass:"three-one"},[e._v(e._s(t.serviceType))]),s("view",{staticClass:"three-two",class:{xixiaaa:2!=t.serviceId}},[e._v("¥"+e._s(t.total-t.insurancePrice))])]),s("view",{staticClass:"br"}),e._l(t.server,function(a,i){return s("view",{key:i,staticClass:"three"},[s("view",{staticClass:"three-one",class:{xixiaaa:"全程监理服务"==a}},[e._v(e._s(a))]),s("view",{staticClass:"three-one",class:{xixiaaa:"全程监理服务"!=a}},[e._v("工程监理责任险")]),s("view",{staticClass:"three-two",class:{xixiaaa:"全程监理服务"!=a}},[e._v("¥"+e._s(t.insurancePrice))]),s("view",{staticClass:"three-two",class:{xixiaaa:"水电节点"!=a}},[e._v("¥299")]),s("view",{staticClass:"three-two",class:{xixiaaa:"泥工节点"!=a}},[e._v("¥299")]),s("view",{staticClass:"three-two",class:{xixiaaa:"木作节点"!=a}},[e._v("¥299")]),s("view",{staticClass:"three-two",class:{xixiaaa:"油漆节点"!=a}},[e._v("¥299")]),s("view",{staticClass:"three-two",class:{xixiaaa:"竣工节点"!=a}},[e._v("¥399")]),s("view",{staticClass:"three-two",class:{xixiaaa:"图纸审核"!=a}},[e._v("¥299")]),s("view",{staticClass:"three-two",class:{xixiaaa:"预算审核"!=a}},[e._v("¥299")]),s("view",{staticClass:"three-two",class:{xixiaaa:"合同陪签"!=a}},[e._v("¥299")]),s("view",{staticClass:"three-two",class:{xixiaaa:"毛坯房验房"!=a}},[e._v("¥299")]),s("view",{staticClass:"three-two",class:{xixiaaa:"精装房验房"!=a}},[e._v("¥399")])])}),s("view",{staticClass:"br"}),s("view",{staticClass:"br"}),s("view",{staticClass:"four"},[s("view",{staticClass:"four-one"},[e._v("合计")]),s("view",{staticClass:"four-two"},[e._v("¥"+e._s(t.total))])]),s("view",{staticClass:"br"}),s("view",{staticClass:"five"},[s("view",{staticClass:"five-one button",attrs:{eventid:"743fefcf-0-"+a},on:{click:function(t){e.order(a)}}},[e._v("订单详情")]),s("view",{staticClass:"five-two button",class:{xixibbb:"待支付"==t.status&&1==t.xixi},attrs:{eventid:"743fefcf-1-"+a},on:{click:function(t){e.pay(a)}}},[e._v("立即支付")]),s("view",{staticClass:"five-two button",class:{xixibbb:"待支付"==t.status&&1!=t.xixi}},[e._v("交易关闭")]),s("view",{staticClass:"five-two button",class:{xixibbb:"已支付"==t.status},attrs:{eventid:"743fefcf-2-"+a},on:{click:function(t){e.assess(a)}}},[e._v("评价")])])],2)])}),s("view",{class:e.orderlen?"no-order none":"no-order"},[s("view",{staticClass:"view"}),s("image",{attrs:{src:"../../static/img/order/no-order.png",mode:"widthFix"}}),s("view",{staticClass:"no-order-contain"},[e._v("目前没有可查看的订单哦~")])])],2)},i=[];s.d(t,"a",function(){return a}),s.d(t,"b",function(){return i})},"8a55":function(e,t,s){},"9df5":function(e,t,s){"use strict";var a=s("8a55"),i=s.n(a);i.a},c819:function(e,t,s){"use strict";s("e8a9");var a=r(s("b0ce")),i=r(s("1549"));function r(e){return e&&e.__esModule?e:{default:e}}Page((0,a.default)(i.default))},f2aa:function(e,t,s){"use strict";s.r(t);var a=s("1170"),i=s.n(a);for(var r in a)"default"!==r&&function(e){s.d(t,e,function(){return a[e]})}(r);t["default"]=i.a}},[["c819","common/runtime","common/vendor"]]]);